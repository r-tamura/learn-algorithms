import test from "ava";
import { addRoundKey } from "./addroundkey";

test("addroundkeys", t => {
  const roundKey = [
    [0x54, 0x73, 0x20, 0x67],
    [0x68, 0x20, 0x4b, 0x20],
    [0x61, 0x6d, 0x75, 0x46],
    [0x74, 0x79, 0x6e, 0x75]
  ];
  const state = [
    [0x54, 0x4f, 0x4e, 0x20],
    [0x77, 0x6e, 0x69, 0x54],
    [0x6f, 0x65, 0x6e, 0x77],
    [0x20, 0x20, 0x65, 0x6f]
  ];
  const expected = [
    [0x00, 0x3c, 0x6e, 0x47],
    [0x1f, 0x4e, 0x22, 0x74],
    [0x0e, 0x08, 0x1b, 0x31],
    [0x54, 0x59, 0x0b, 0x1a]
  ];
  const actual = addRoundKey(state, roundKey);
  t.deepEqual(actual, expected);
});

test("addroundkeys Inverse", t => {
  const roundKey = [
    [0x54, 0x73, 0x20, 0x67],
    [0x68, 0x20, 0x4b, 0x20],
    [0x61, 0x6d, 0x75, 0x46],
    [0x74, 0x79, 0x6e, 0x75]
  ];
  const state = [
    [0x00, 0x3c, 0x6e, 0x47],
    [0x1f, 0x4e, 0x22, 0x74],
    [0x0e, 0x08, 0x1b, 0x31],
    [0x54, 0x59, 0x0b, 0x1a]
  ];
  const expected = [
    [0x54, 0x4f, 0x4e, 0x20],
    [0x77, 0x6e, 0x69, 0x54],
    [0x6f, 0x65, 0x6e, 0x77],
    [0x20, 0x20, 0x65, 0x6f]
  ];
  const actual = addRoundKey(state, roundKey);
  t.deepEqual(actual, expected);
});
