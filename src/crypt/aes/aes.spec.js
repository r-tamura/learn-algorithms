import test from "ava"
import { encrypt, decrypt } from "./aes"

const plain = new Buffer([ 
  0x54, 0x77, 0x6f, 0x20, 0x4f, 0x6e, 0x65, 0x20, 0x4e, 0x69, 0x6e, 0x65, 0x20, 0x54, 0x77, 0x6f, 
])
const encrypted = new Buffer([
  0x29 ,0xc3 ,0x50 ,0x5f ,0x57 ,0x14 ,0x20 ,0xf6 ,0x40 ,0x22 ,0x99 ,0xb3 ,0x1a ,0x02 ,0xd7 ,0x3a,
])

const key = new Buffer([
  0x54, 0x68, 0x61, 0x74, 0x73, 0x20, 0x6d, 0x79, 0x20, 0x4b, 0x75, 0x6e, 0x67, 0x20, 0x46, 0x75,
])

test("Encrypt a 128bit data", t => {
  const expected = encrypted
  const actual = encrypt(plain, key)
  t.deepEqual(actual, expected)
})

test("Decrypt a 128bit data", t => {
  const expected = plain
  const actual = decrypt(encrypted, key)
  t.deepEqual(actual, expected)
}) 
