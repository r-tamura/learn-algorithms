import test from "ava";
import pkcs7 from "./pkcs7";

test("pkcs7 pad", t => {
  const data = Buffer.from([0x01, 0x01, 0x02, 0x04]);
  const blockSize = 16;
  const expected = Buffer.from([
    0x01,
    0x01,
    0x02,
    0x04,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c
  ]);
  const actual = pkcs7.pad(data, 16);
  t.deepEqual(actual, expected);
});

test("pkcs7 unpad", t => {
  const data = Buffer.from([
    0x01,
    0x01,
    0x02,
    0x04,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c,
    0x0c
  ]);
  const expected = Buffer.from([0x01, 0x01, 0x02, 0x04]);
  const actual = pkcs7.unpad(data);
  t.deepEqual(actual, expected);
});
